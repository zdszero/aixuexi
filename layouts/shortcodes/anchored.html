{{- $isBlock := .Get "block" | default "false" -}}
<span id="{{ .Get "id" }}"
      class="anchored-text {{ if eq $isBlock "true" }}anchored-block{{ end }}"
      onclick="location.hash='{{ .Get `id` }}'">
  <span class="anchor-label">{{ .Inner | markdownify }}</span>
  <svg class="anchor-icon" viewBox="0 0 24 24" width="14" height="14" fill="currentColor" aria-hidden="true">
    <path d="M3.9 12a5 5 0 0 1 5-5h3v2h-3a3 3 0 0 0 0 6h3v2h-3a5 5 0 0 1-5-5zm6-1h4v2h-4v-2zm6.1-4a5 5 0 0 1 0 10h-3v-2h3a3 3 0 0 0 0-6h-3V7h3z"/>
  </svg>
</span>

{{- if not ($.Page.Scratch.Get "anchor-flag") -}}
{{- $.Page.Scratch.Set "anchor-flag" true -}}

<style>
.anchored-text {
  scroll-margin-top: 80px;
  cursor: pointer;
  color: #1e88e5;
  display: inline-flex;
  align-items: center;
  gap: 0.3em;
  font-weight: 500;
  text-decoration: none;
  border-bottom: 1px dotted rgba(30, 136, 229, 0.5);
  transition: color 0.2s ease, border-bottom-color 0.2s ease;
}

.anchored-text:hover {
  color: #0d47a1;
}

.anchored-text .anchor-icon {
  position: relative;
  right: 0;
  top: 0.1em;
  opacity: 1;
  vertical-align: middle;
  transition: opacity 0.2s ease;
  pointer-events: none;
}

.anchored-text:hover .anchor-icon {
  opacity: 1;
}

.anchored-block {
  display: block;
  font-size: 1.1em;
  margin: 1em 0;
}

.anchor-label {
  unicode-bidi: isolate;
}
</style>

{{- end -}}
