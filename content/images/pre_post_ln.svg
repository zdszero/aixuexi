<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 13.1.0 (20250701.0955)
 -->
<!-- Title: TransformerBlocks Pages: 1 -->
<svg width="458pt" height="755pt"
 viewBox="0.00 0.00 458.00 755.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 750.75)">
<title>TransformerBlocks</title>
<g id="clust1" class="cluster">
<title>cluster_postln</title>
<path fill="none" stroke="gray" d="M20,-8C20,-8 218,-8 218,-8 224,-8 230,-14 230,-20 230,-20 230,-726.75 230,-726.75 230,-732.75 224,-738.75 218,-738.75 218,-738.75 20,-738.75 20,-738.75 14,-738.75 8,-732.75 8,-726.75 8,-726.75 8,-20 8,-20 8,-14 14,-8 20,-8"/>
<text xml:space="preserve" text-anchor="middle" x="119" y="-723.35" font-family="Helvetica,sans-Serif" font-size="12.00">Post&#45;LayerNorm (Original Transformer)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_preln</title>
<path fill="none" stroke="gray" d="M250,-8C250,-8 430,-8 430,-8 436,-8 442,-14 442,-20 442,-20 442,-726.75 442,-726.75 442,-732.75 436,-738.75 430,-738.75 430,-738.75 250,-738.75 250,-738.75 244,-738.75 238,-732.75 238,-726.75 238,-726.75 238,-20 238,-20 238,-14 244,-8 250,-8"/>
<text xml:space="preserve" text-anchor="middle" x="340" y="-723.35" font-family="Helvetica,sans-Serif" font-size="12.00">Pre&#45;LayerNorm (Modern GPT&#45;style)</text>
</g>
<!-- x_l_post -->
<g id="node1" class="node">
<title>x_l_post</title>
<path fill="#eeeeee" stroke="black" d="M118,-710C118,-710 88,-710 88,-710 82,-710 76,-704 76,-698 76,-698 76,-686 76,-686 76,-680 82,-674 88,-674 88,-674 118,-674 118,-674 124,-674 130,-680 130,-686 130,-686 130,-698 130,-698 130,-704 124,-710 118,-710"/>
<text xml:space="preserve" text-anchor="middle" x="103" y="-688.12" font-family="Helvetica,sans-Serif" font-size="10.00">x1</text>
</g>
<!-- mha_post -->
<g id="node2" class="node">
<title>mha_post</title>
<path fill="#f4c430" stroke="black" d="M84.62,-616C84.62,-616 45.38,-616 45.38,-616 39.38,-616 33.38,-610 33.38,-604 33.38,-604 33.38,-592 33.38,-592 33.38,-586 39.38,-580 45.38,-580 45.38,-580 84.62,-580 84.62,-580 90.62,-580 96.62,-586 96.62,-592 96.62,-592 96.62,-604 96.62,-604 96.62,-610 90.62,-616 84.62,-616"/>
<text xml:space="preserve" text-anchor="middle" x="65" y="-599.75" font-family="Helvetica,sans-Serif" font-size="10.00">Multi&#45;Head</text>
<text xml:space="preserve" text-anchor="middle" x="65" y="-588.5" font-family="Helvetica,sans-Serif" font-size="10.00">Attention</text>
</g>
<!-- x_l_post&#45;&gt;mha_post -->
<g id="edge1" class="edge">
<title>x_l_post&#45;&gt;mha_post</title>
<path fill="none" stroke="black" d="M95.85,-673.7C90.07,-659.69 81.84,-639.77 75.34,-624.03"/>
<polygon fill="black" stroke="black" points="77.63,-623.16 72.69,-617.63 73.1,-625.03 77.63,-623.16"/>
</g>
<!-- add1_post -->
<g id="node3" class="node">
<title>add1_post</title>
<path fill="#ffffff" stroke="black" d="M97,-522C97,-522 67,-522 67,-522 61,-522 55,-516 55,-510 55,-510 55,-498 55,-498 55,-492 61,-486 67,-486 67,-486 97,-486 97,-486 103,-486 109,-492 109,-498 109,-498 109,-510 109,-510 109,-516 103,-522 97,-522"/>
<text xml:space="preserve" text-anchor="middle" x="82" y="-500.12" font-family="Helvetica,sans-Serif" font-size="10.00">addition</text>
</g>
<!-- x_l_post&#45;&gt;add1_post -->
<g id="edge3" class="edge">
<title>x_l_post&#45;&gt;add1_post</title>
<path fill="none" stroke="black" d="M109.18,-673.52C116.1,-651.51 125.42,-612.61 118,-580 113.93,-562.13 105.05,-543.55 97.13,-529.35"/>
<polygon fill="black" stroke="black" points="99.48,-528.51 93.86,-523.67 95.23,-530.96 99.48,-528.51"/>
</g>
<!-- mha_post&#45;&gt;add1_post -->
<g id="edge2" class="edge">
<title>mha_post&#45;&gt;add1_post</title>
<path fill="none" stroke="black" d="M68.2,-579.7C70.76,-565.82 74.4,-546.14 77.3,-530.46"/>
<polygon fill="black" stroke="black" points="79.68,-531.04 78.54,-523.72 74.86,-530.15 79.68,-531.04"/>
</g>
<!-- ln1_post -->
<g id="node4" class="node">
<title>ln1_post</title>
<path fill="#9acd32" stroke="black" d="M103.5,-428C103.5,-428 60.5,-428 60.5,-428 54.5,-428 48.5,-422 48.5,-416 48.5,-416 48.5,-404 48.5,-404 48.5,-398 54.5,-392 60.5,-392 60.5,-392 103.5,-392 103.5,-392 109.5,-392 115.5,-398 115.5,-404 115.5,-404 115.5,-416 115.5,-416 115.5,-422 109.5,-428 103.5,-428"/>
<text xml:space="preserve" text-anchor="middle" x="82" y="-406.12" font-family="Helvetica,sans-Serif" font-size="10.00">Layer Norm</text>
</g>
<!-- add1_post&#45;&gt;ln1_post -->
<g id="edge4" class="edge">
<title>add1_post&#45;&gt;ln1_post</title>
<path fill="none" stroke="black" d="M82,-485.7C82,-471.82 82,-452.14 82,-436.46"/>
<polygon fill="black" stroke="black" points="84.45,-436.74 82,-429.74 79.55,-436.74 84.45,-436.74"/>
</g>
<!-- ffn_post -->
<g id="node5" class="node">
<title>ffn_post</title>
<path fill="#87ceeb" stroke="black" d="M61,-334C61,-334 31,-334 31,-334 25,-334 19,-328 19,-322 19,-322 19,-310 19,-310 19,-304 25,-298 31,-298 31,-298 61,-298 61,-298 67,-298 73,-304 73,-310 73,-310 73,-322 73,-322 73,-328 67,-334 61,-334"/>
<text xml:space="preserve" text-anchor="middle" x="46" y="-312.12" font-family="Helvetica,sans-Serif" font-size="10.00">FFN</text>
</g>
<!-- ln1_post&#45;&gt;ffn_post -->
<g id="edge5" class="edge">
<title>ln1_post&#45;&gt;ffn_post</title>
<path fill="none" stroke="black" d="M75.23,-391.7C69.75,-377.69 61.95,-357.77 55.79,-342.03"/>
<polygon fill="black" stroke="black" points="58.12,-341.26 53.29,-335.64 53.56,-343.05 58.12,-341.26"/>
</g>
<!-- add2_post -->
<g id="node6" class="node">
<title>add2_post</title>
<path fill="#ffffff" stroke="black" d="M98,-240C98,-240 68,-240 68,-240 62,-240 56,-234 56,-228 56,-228 56,-216 56,-216 56,-210 62,-204 68,-204 68,-204 98,-204 98,-204 104,-204 110,-210 110,-216 110,-216 110,-228 110,-228 110,-234 104,-240 98,-240"/>
<text xml:space="preserve" text-anchor="middle" x="83" y="-218.12" font-family="Helvetica,sans-Serif" font-size="10.00">addition</text>
</g>
<!-- ln1_post&#45;&gt;add2_post -->
<g id="edge7" class="edge">
<title>ln1_post&#45;&gt;add2_post</title>
<path fill="none" stroke="black" d="M85.9,-391.53C89.07,-376.4 93.29,-353.88 95,-334 97.52,-304.68 92.83,-271.09 88.6,-248.61"/>
<polygon fill="black" stroke="black" points="91,-248.16 87.24,-241.77 86.2,-249.11 91,-248.16"/>
</g>
<!-- ffn_post&#45;&gt;add2_post -->
<g id="edge6" class="edge">
<title>ffn_post&#45;&gt;add2_post</title>
<path fill="none" stroke="black" d="M52.96,-297.7C58.59,-283.69 66.6,-263.77 72.93,-248.03"/>
<polygon fill="black" stroke="black" points="75.17,-249.04 75.51,-241.63 70.62,-247.21 75.17,-249.04"/>
</g>
<!-- ln2_post -->
<g id="node7" class="node">
<title>ln2_post</title>
<path fill="#9acd32" stroke="black" d="M104.5,-146C104.5,-146 61.5,-146 61.5,-146 55.5,-146 49.5,-140 49.5,-134 49.5,-134 49.5,-122 49.5,-122 49.5,-116 55.5,-110 61.5,-110 61.5,-110 104.5,-110 104.5,-110 110.5,-110 116.5,-116 116.5,-122 116.5,-122 116.5,-134 116.5,-134 116.5,-140 110.5,-146 104.5,-146"/>
<text xml:space="preserve" text-anchor="middle" x="83" y="-124.12" font-family="Helvetica,sans-Serif" font-size="10.00">Layer Norm</text>
</g>
<!-- add2_post&#45;&gt;ln2_post -->
<g id="edge8" class="edge">
<title>add2_post&#45;&gt;ln2_post</title>
<path fill="none" stroke="black" d="M83,-203.7C83,-189.82 83,-170.14 83,-154.46"/>
<polygon fill="black" stroke="black" points="85.45,-154.74 83,-147.74 80.55,-154.74 85.45,-154.74"/>
</g>
<!-- x_lp1_post -->
<g id="node8" class="node">
<title>x_lp1_post</title>
<path fill="#eeeeee" stroke="black" d="M98,-52C98,-52 68,-52 68,-52 62,-52 56,-46 56,-40 56,-40 56,-28 56,-28 56,-22 62,-16 68,-16 68,-16 98,-16 98,-16 104,-16 110,-22 110,-28 110,-28 110,-40 110,-40 110,-46 104,-52 98,-52"/>
<text xml:space="preserve" text-anchor="middle" x="83" y="-30.12" font-family="Helvetica,sans-Serif" font-size="10.00">x2</text>
</g>
<!-- ln2_post&#45;&gt;x_lp1_post -->
<g id="edge9" class="edge">
<title>ln2_post&#45;&gt;x_lp1_post</title>
<path fill="none" stroke="black" d="M83,-109.7C83,-95.82 83,-76.14 83,-60.46"/>
<polygon fill="black" stroke="black" points="85.45,-60.74 83,-53.74 80.55,-60.74 85.45,-60.74"/>
</g>
<!-- x_l_pre -->
<g id="node9" class="node">
<title>x_l_pre</title>
<path fill="#eeeeee" stroke="black" d="M334,-710C334,-710 304,-710 304,-710 298,-710 292,-704 292,-698 292,-698 292,-686 292,-686 292,-680 298,-674 304,-674 304,-674 334,-674 334,-674 340,-674 346,-680 346,-686 346,-686 346,-698 346,-698 346,-704 340,-710 334,-710"/>
<text xml:space="preserve" text-anchor="middle" x="319" y="-688.12" font-family="Helvetica,sans-Serif" font-size="10.00">x1</text>
</g>
<!-- ln1_pre -->
<g id="node10" class="node">
<title>ln1_pre</title>
<path fill="#9acd32" stroke="black" d="M301.5,-616C301.5,-616 258.5,-616 258.5,-616 252.5,-616 246.5,-610 246.5,-604 246.5,-604 246.5,-592 246.5,-592 246.5,-586 252.5,-580 258.5,-580 258.5,-580 301.5,-580 301.5,-580 307.5,-580 313.5,-586 313.5,-592 313.5,-592 313.5,-604 313.5,-604 313.5,-610 307.5,-616 301.5,-616"/>
<text xml:space="preserve" text-anchor="middle" x="280" y="-594.12" font-family="Helvetica,sans-Serif" font-size="10.00">Layer Norm</text>
</g>
<!-- x_l_pre&#45;&gt;ln1_pre -->
<g id="edge10" class="edge">
<title>x_l_pre&#45;&gt;ln1_pre</title>
<path fill="none" stroke="black" d="M311.66,-673.7C305.73,-659.69 297.28,-639.77 290.61,-624.03"/>
<polygon fill="black" stroke="black" points="292.88,-623.11 287.89,-617.62 288.37,-625.02 292.88,-623.11"/>
</g>
<!-- add1_pre -->
<g id="node12" class="node">
<title>add1_pre</title>
<path fill="#ffffff" stroke="black" d="M296,-428C296,-428 266,-428 266,-428 260,-428 254,-422 254,-416 254,-416 254,-404 254,-404 254,-398 260,-392 266,-392 266,-392 296,-392 296,-392 302,-392 308,-398 308,-404 308,-404 308,-416 308,-416 308,-422 302,-428 296,-428"/>
<text xml:space="preserve" text-anchor="middle" x="281" y="-406.12" font-family="Helvetica,sans-Serif" font-size="10.00">addition</text>
</g>
<!-- x_l_pre&#45;&gt;add1_pre -->
<g id="edge13" class="edge">
<title>x_l_pre&#45;&gt;add1_pre</title>
<path fill="none" stroke="black" d="M324.55,-673.74C335.2,-637.79 355.59,-552.72 334,-486 327.84,-466.97 314.99,-448.57 303.48,-434.77"/>
<polygon fill="black" stroke="black" points="305.39,-433.23 298.97,-429.52 301.68,-436.42 305.39,-433.23"/>
</g>
<!-- mha_pre -->
<g id="node11" class="node">
<title>mha_pre</title>
<path fill="#f4c430" stroke="black" d="M300.62,-522C300.62,-522 261.38,-522 261.38,-522 255.38,-522 249.38,-516 249.38,-510 249.38,-510 249.38,-498 249.38,-498 249.38,-492 255.38,-486 261.38,-486 261.38,-486 300.62,-486 300.62,-486 306.62,-486 312.62,-492 312.62,-498 312.62,-498 312.62,-510 312.62,-510 312.62,-516 306.62,-522 300.62,-522"/>
<text xml:space="preserve" text-anchor="middle" x="281" y="-505.75" font-family="Helvetica,sans-Serif" font-size="10.00">Multi&#45;Head</text>
<text xml:space="preserve" text-anchor="middle" x="281" y="-494.5" font-family="Helvetica,sans-Serif" font-size="10.00">Attention</text>
</g>
<!-- ln1_pre&#45;&gt;mha_pre -->
<g id="edge11" class="edge">
<title>ln1_pre&#45;&gt;mha_pre</title>
<path fill="none" stroke="black" d="M280.19,-579.7C280.34,-565.82 280.55,-546.14 280.72,-530.46"/>
<polygon fill="black" stroke="black" points="283.17,-530.77 280.8,-523.74 278.27,-530.71 283.17,-530.77"/>
</g>
<!-- mha_pre&#45;&gt;add1_pre -->
<g id="edge12" class="edge">
<title>mha_pre&#45;&gt;add1_pre</title>
<path fill="none" stroke="black" d="M281,-485.7C281,-471.82 281,-452.14 281,-436.46"/>
<polygon fill="black" stroke="black" points="283.45,-436.74 281,-429.74 278.55,-436.74 283.45,-436.74"/>
</g>
<!-- ln2_pre -->
<g id="node13" class="node">
<title>ln2_pre</title>
<path fill="#9acd32" stroke="black" d="M302.5,-334C302.5,-334 259.5,-334 259.5,-334 253.5,-334 247.5,-328 247.5,-322 247.5,-322 247.5,-310 247.5,-310 247.5,-304 253.5,-298 259.5,-298 259.5,-298 302.5,-298 302.5,-298 308.5,-298 314.5,-304 314.5,-310 314.5,-310 314.5,-322 314.5,-322 314.5,-328 308.5,-334 302.5,-334"/>
<text xml:space="preserve" text-anchor="middle" x="281" y="-312.12" font-family="Helvetica,sans-Serif" font-size="10.00">Layer Norm</text>
</g>
<!-- add1_pre&#45;&gt;ln2_pre -->
<g id="edge14" class="edge">
<title>add1_pre&#45;&gt;ln2_pre</title>
<path fill="none" stroke="black" d="M281,-391.7C281,-377.82 281,-358.14 281,-342.46"/>
<polygon fill="black" stroke="black" points="283.45,-342.74 281,-335.74 278.55,-342.74 283.45,-342.74"/>
</g>
<!-- add2_pre -->
<g id="node15" class="node">
<title>add2_pre</title>
<path fill="#ffffff" stroke="black" d="M338,-146C338,-146 308,-146 308,-146 302,-146 296,-140 296,-134 296,-134 296,-122 296,-122 296,-116 302,-110 308,-110 308,-110 338,-110 338,-110 344,-110 350,-116 350,-122 350,-122 350,-134 350,-134 350,-140 344,-146 338,-146"/>
<text xml:space="preserve" text-anchor="middle" x="323" y="-124.12" font-family="Helvetica,sans-Serif" font-size="10.00">addition</text>
</g>
<!-- add1_pre&#45;&gt;add2_pre -->
<g id="edge17" class="edge">
<title>add1_pre&#45;&gt;add2_pre</title>
<path fill="none" stroke="black" d="M298.67,-391.77C311.81,-377.65 328.67,-356.4 336,-334 356.35,-271.82 340.86,-193.49 330.44,-154.08"/>
<polygon fill="black" stroke="black" points="332.92,-153.85 328.71,-147.74 328.19,-155.14 332.92,-153.85"/>
</g>
<!-- ffn_pre -->
<g id="node14" class="node">
<title>ffn_pre</title>
<path fill="#87ceeb" stroke="black" d="M299,-240C299,-240 269,-240 269,-240 263,-240 257,-234 257,-228 257,-228 257,-216 257,-216 257,-210 263,-204 269,-204 269,-204 299,-204 299,-204 305,-204 311,-210 311,-216 311,-216 311,-228 311,-228 311,-234 305,-240 299,-240"/>
<text xml:space="preserve" text-anchor="middle" x="284" y="-218.12" font-family="Helvetica,sans-Serif" font-size="10.00">FFN</text>
</g>
<!-- ln2_pre&#45;&gt;ffn_pre -->
<g id="edge15" class="edge">
<title>ln2_pre&#45;&gt;ffn_pre</title>
<path fill="none" stroke="black" d="M281.56,-297.7C282.02,-283.82 282.66,-264.14 283.17,-248.46"/>
<polygon fill="black" stroke="black" points="285.61,-248.82 283.39,-241.74 280.71,-248.66 285.61,-248.82"/>
</g>
<!-- ffn_pre&#45;&gt;add2_pre -->
<g id="edge16" class="edge">
<title>ffn_pre&#45;&gt;add2_pre</title>
<path fill="none" stroke="black" d="M291.34,-203.7C297.27,-189.69 305.72,-169.77 312.39,-154.03"/>
<polygon fill="black" stroke="black" points="314.63,-155.02 315.11,-147.62 310.12,-153.11 314.63,-155.02"/>
</g>
<!-- x_lp1_pre -->
<g id="node16" class="node">
<title>x_lp1_pre</title>
<path fill="#eeeeee" stroke="black" d="M338,-52C338,-52 308,-52 308,-52 302,-52 296,-46 296,-40 296,-40 296,-28 296,-28 296,-22 302,-16 308,-16 308,-16 338,-16 338,-16 344,-16 350,-22 350,-28 350,-28 350,-40 350,-40 350,-46 344,-52 338,-52"/>
<text xml:space="preserve" text-anchor="middle" x="323" y="-30.12" font-family="Helvetica,sans-Serif" font-size="10.00">x2</text>
</g>
<!-- add2_pre&#45;&gt;x_lp1_pre -->
<g id="edge18" class="edge">
<title>add2_pre&#45;&gt;x_lp1_pre</title>
<path fill="none" stroke="black" d="M323,-109.7C323,-95.82 323,-76.14 323,-60.46"/>
<polygon fill="black" stroke="black" points="325.45,-60.74 323,-53.74 320.55,-60.74 325.45,-60.74"/>
</g>
</g>
</svg>
